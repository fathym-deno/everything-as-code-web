Deno.test("Azure RBAC Service Principal", async () => {
  const createApp = await fetch(
    "https://graph.microsoft.com/v1.0/applications",
    {
      method: "POST",
      body: JSON.stringify({
        displayName: "fathym-test",
      }),
      headers: {
        "Client-Request-Id": crypto.randomUUID(),
        "Content-Type": "application/json",
        Authorization:
          "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjlHbW55RlBraGMzaE91UjIybXZTdmduTG83WSIsImtpZCI6IjlHbW55RlBraGMzaE91UjIybXZTdmduTG83WSJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuY29yZS53aW5kb3dzLm5ldC8iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC82ZGNiZWJkMC1mOGQwLTRhOWQtODllNS01ODczZTgxNDZiMGEvIiwiaWF0IjoxNjk5NTE0NjI0LCJuYmYiOjE2OTk1MTQ2MjQsImV4cCI6MTY5OTUxODc5NywiYWNyIjoiMSIsImFpbyI6IkFWUUFxLzhWQUFBQVhwZGZoVUQ1bXdpaWdMM3lWUnM1MklBb2J4WkxMeStGa2NTNytENEk3SmdQSFdUMkY2cGtDWERPSTB0VmZOdFhTVXdWT3k5aExNY3M4UkFiVEkyL0R2RFJCR01OMTVPOHl1WDJpRWs4NWZzPSIsImFtciI6WyJwd2QiLCJtZmEiXSwiYXBwaWQiOiJlOWI5Y2JlOC1hZDk2LTQ2YWMtODg5YS02NDQ2MzdiYWZmOWUiLCJhcHBpZGFjciI6IjEiLCJmYW1pbHlfbmFtZSI6IkdlYXJoYXJkdCIsImdpdmVuX25hbWUiOiJNaWNoYWVsIiwiZ3JvdXBzIjpbIjVhMzE0MDQxLTRiMDctNDdlYy05YzZlLTAxNDM1MDQ4NzI2MyIsIjgwZjE1M2E4LTAxYTUtNGQ5OC04NDYyLWEwNjkxZjdkOGM1YSIsIjEwYTJlNjU3LTFmZDItNGI0OS05ZTRlLTc1OWIwNzBmZTBlMiIsImYxMTQyN2VlLTE3YWYtNDVlNC05ZTA1LTZiNTQ3ZDc4YjZlYyJdLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiI5OC40My45OS4xNTEiLCJuYW1lIjoiTWljaGFlbCBHZWFyaGFyZHQiLCJvaWQiOiI2NmY0NWZhZS1mMDgwLTQwMDItYWJhOS1lYWRhYzNkZjZlMjIiLCJwdWlkIjoiMTAwMzNGRkZBM0E0QjMyOCIsInJoIjoiMC5BU2dBME92TGJkRDRuVXFKNVZoejZCUnJDa1pJZjNrQXV0ZFB1a1Bhd2ZqMk1CUFpBTDguIiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoiUE9kdkhrUm9PQWppMHF0TGwyVm1ybm5DclBya2RSOVJoYjcwQ0hQRHptTSIsInRpZCI6IjZkY2JlYmQwLWY4ZDAtNGE5ZC04OWU1LTU4NzNlODE0NmIwYSIsInVuaXF1ZV9uYW1lIjoibWljaGFlbC5nZWFyaGFyZHRAZmF0aHltLmNvbSIsInVwbiI6Im1pY2hhZWwuZ2VhcmhhcmR0QGZhdGh5bS5jb20iLCJ1dGkiOiJJcFAyZXM2VkxVVzE3dF9SVTg0REFRIiwidmVyIjoiMS4wIiwid2lkcyI6WyI5Yjg5NWQ5Mi0yY2QzLTQ0YzctOWQwMi1hNmFjMmQ1ZWE1YzMiLCI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLCJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX2NhZSI6IjEiLCJ4bXNfdGNkdCI6MTUwMTQ0MzM3MX0.xIa-eD8OXnkAijivJlHn0FwjYn99N1VyMStx6xOcNC1f3UD74gAcDLSVxdfTOfNtSzFr55U7L-HHjVr_4FlOx81yFEOx08PsUwuakY1Ac3NdXnK1zjSkkfHz4Lx3XYqKmGT5cAwp7RzPLrXdTEuIGPDcsOUD6Ch9jf4Zg7kT4w7oZqkMRaGxVFekRLC5GWnmWkzfNVFcHRdCjt3mzorz_1w3vLziPmJnhOJJ1O-OlLj10gJmVm6YM8V-4SqV98GgrAitOrEQFfNp8VCxrLjSnOdgT1h_o8OZWMhR9i1sVBU6XbtQE0O9AHeJ63mNKi4pz6DZrRLjN2prsXWuiHcWtw",
      },
    },
  );

  const appResp = await createApp.json();

  console.log(appResp);
});
